# 【OFFICE】EXCEL常用公式大整理

## 核心計算與邏輯函式 (Basic & Logic Functions)

| 函式 | 說明 | 語法 (Syntax) | 範例 (Example) |
| --- | --- | --- | --- |
| **SUM** | 計算所選範圍內所有數值的**總和**。 | `=SUM(number1, [number2], ...)` 或 `=SUM(range)` | `=SUM(A1:A10)`：計算 A1 到 A10 儲存格的總和。 |
| **AVERAGE** | 計算所選範圍內所有數值的**平均值**。 | `=AVERAGE(number1, [number2], ...)` 或 `=AVERAGE(range)` | `=AVERAGE(B1:B5)`：計算 B1 到 B5 的平均。 |
| **IF** | 進行**條件判斷**。如果條件成立（TRUE），則傳回第一個值；否則（FALSE），則傳回第二個值。 | `=IF(logical_test, value_if_true, value_if_false)` | `=IF(C2>60, "及格", "不及格")`：如果 C2 大於 60，顯示「及格」，否則顯示「不及格」。 |
| **COUNT** | 計算範圍內包含**數字**的儲存格個數。 | `=COUNT(range)` | `=COUNT(A:A)`：計算 A 欄中有多少個數字。 |
| **COUNTA** | 計算範圍內**非空**（有任何內容）的儲存格個數。 | `=COUNTA(range)` | `=COUNTA(B1:B100)`：計算 B1 到 B100 有多少個有資料的儲存格。 |

## 條件式計算函式 (Conditional Calculations)

這些函式是實戰中最常用的，能讓你根據特定**條件**來計算、求和或計數。

| 函式 | 說明 | 語法 (Syntax) | 範例 (Example) |
| --- | --- | --- | --- |
| **COUNTIF** | 根據**單一條件**，計算範圍內符合條件的儲存格個數。 | `=COUNTIF(range, criteria)` | `=COUNTIF(D:D, "業務部")`：計算 D 欄中為「業務部」的數量。 |
| **SUMIF** | 根據**單一條件**，對另一個範圍內的數值進行**加總**。 | `=SUMIF(range, criteria, [sum_range])` | `=SUMIF(A:A, ">100", B:B)`：在 A 欄中找出大於 100 的項目，然後加總 B 欄對應的數值。 |
| **AVERAGEIF** | 根據**單一條件**，計算符合條件的數值**平均值**。 | `=AVERAGEIF(range, criteria, [average_range])` | `=AVERAGEIF(C:C, "高", E:E)`：計算 C 欄為「高」時，E 欄數值的平均。 |
| **SUMIFS** | 根據**多重條件**，對另一個範圍內的數值進行**加總** (注意語法順序與 `SUMIF` 不同)。 | `=SUMIFS(sum_range, criteria_range1, criteria1, [criteria_range2, criteria2], ...)` | `=SUMIFS(C:C, A:A, "A產品", B:B, "台北")`：加總 C 欄數值，條件是 A 欄為「A產品」*且* B 欄為「台北」。 |
| **COUNTIFS** | 根據**多重條件**，計算符合所有條件的儲存格個數。 | `=COUNTIFS(criteria_range1, criteria1, [criteria_range2, criteria2], ...)` | `=COUNTIFS(A:A, "<2024/1/1", B:B, "完成")`：計算 A 欄日期早於 2024/1/1 *且* B 欄為「完成」的數量。 |

## 查找與排名函式 (Lookup & Ranking Functions)

**查找**是將兩個表格或資料庫串接的核心，是面試必考題。

| 函式 | 說明 | 語法 (Syntax) | 範例 (Example) | 備註 |
| --- | --- | --- | --- | --- |
| **VLOOKUP** | 在**垂直**（V）欄位中查找某一數值，並傳回同一列中指定欄的數值。 | `=VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])` | `=VLOOKUP(A2, C:E, 3, FALSE)`：在 C 到 E 欄中尋找 A2 的值，並傳回第 3 欄（E 欄）對應的值。`FALSE` 表示精確比對。 | 面試常考。只能從左往右查。 |
| **XLOOKUP** | 新一代的查找函式，更強大、更靈活，可以**雙向查找**，預設為精確比對。 | `=XLOOKUP(lookup_value, lookup_array, return_array, [if_not_found], [match_mode], [search_mode])` | `=XLOOKUP(A2, C:C, E:E, "找不到")`：在 C 欄中尋找 A2 的值，並傳回 E 欄對應的值。如果找不到，顯示「找不到」。 | 推薦日常使用。 |
| **RANK** | 傳回一個數值在某一數值清單中的**排名**。 | `=RANK(number, ref, [order])` | `=RANK(B2, B:B, 0)`：計算 B2 在 B 欄所有數值中的排名。`0` 表示降冪（數值越大，排名越前）。 |  |
| **INDEX + MATCH** | 這是 `VLOOKUP` 的**替代方案**，更靈活，可以**雙向查找**，且效率更高。 | **`MATCH`**：先找出某數值在範圍內的位置。`=MATCH(lookup_value, lookup_array, [match_type])**INDEX**`：根據位置（列與欄號）傳回儲存格的值。`=INDEX(array, row_num, [column_num])` | `MATCH("產品名稱", A:A, 0)` → 傳回 "產品名稱" 在 A 欄的位置 (例: 5)。
 `INDEX(B:B, 5)` → 傳回 B 欄第 5 列的值。 
 **組合式：** `=INDEX(B:B, MATCH(C2, A:A, 0))` | 進階查找，面試中能使用這個組合能展現你對 Excel 的深入理解。 |

## 資料清理與管理實用功能 (Data Cleaning & Management Features)

這部分雖然不是函式，但卻是處理「**髒亂**」原始資料時**最常**用到的功能，也是面試實作中可能會考驗的。

### 1. 資料剖析 (Text to Columns) - **面試常考**

- **用途**：將一個儲存格中包含分隔符號（如逗號、空格、斜線等）的資料，**拆分**到多個相鄰的儲存格中。
- **步驟**：
    1. 選取要拆分的資料欄。
    2. 到功能區的 **【資料】** 頁籤。
    3. 點擊 **【資料工具】** 群組中的 **【資料剖析】**。
    4. 選擇 **【分隔符號】** (如逗號或空格) 或 **【固定寬度】**。
    5. 設定分隔符號或寬度，並指定「目的地」儲存格，完成。
- **範例**：將 `A1` 儲存格的 `"王小明,業務部,台北"` 拆分成 `B1` 的「王小明」、`C1` 的「業務部」和 `D1` 的「台北」。

### 2. 移除重複項 (Remove Duplicates)

- **用途**：快速刪除資料範圍中**完全相同**的列，只留下**唯一**的一筆資料。
- **步驟**：
    1. 選取包含要檢查重複資料的範圍。
    2. 到功能區的 **【資料】** 頁籤。
    3. 點擊 **【資料工具】** 群組中的 **【移除重複項】**。
    4. 勾選你想要用來判斷「重複」的欄位（通常是所有欄位），點擊確定。
- **範例**：在一份訂單清單中，快速刪除重複輸入的訂單編號。

### 3. 資料篩選與排序 (Filter & Sort)

- **用途**：快速查看或重新排列資料。
- **操作**：
    1. 選取資料範圍的**標題列**。
    2. 到 **【資料】** 頁籤，點擊 **【篩選】** 圖示。
    3. 點擊標題列上的倒三角形圖示即可進行：
        - **排序**：依據數值、字母或日期進行升冪/降冪排列。
        - **篩選**：僅顯示符合特定條件（如只看「業務部」、只看「>500」的數值）的列。

### 4. 條件式格式設定 (Conditional Formatting)

- **用途**：根據**儲存格的數值**，自動**改變其外觀**（如變色、加粗），用於突顯重要或異常資料。
- **步驟**：
    1. 選取要設定格式的範圍。
    2. 到功能區的 **【常用】** 頁籤。
    3. 點擊 **【條件式格式設定】**。
    4. 可選擇如「醒目提示儲存格規則」（如大於、小於、介於）或「資料橫條」（以圖形顯示數值大小）。
- **範例**：將所有業績超過 100 萬的儲存格底色變成綠色。

---

## 總結與面試技巧

在面試中，光是寫出函式名稱和語法是不夠的，更重要的是：

1. **解決問題的思路**：如何將一個實際問題（例如：「計算業務部且業績大於 50 萬的單數」）轉化為對應的 Excel 函式（`COUNTIFS`）。
2. **資料結構的概念**：了解查找函式（`VLOOKUP` 或 `XLOOKUP`）要求你的資料表格必須是標準、整齊的。
3. **錯誤處理**：能識別並處理常見錯誤，例如 `VLOOKUP` 找不到會出現 **`#N/A`**，並能使用 `IFERROR` 函式來美化結果。

### 額外推薦：錯誤處理函式

| 函式 | 說明 | 語法 (Syntax) | 範例 (Example) |
| --- | --- | --- | --- |
| **IFERROR** | 檢查計算是否產生**錯誤**，若有，則傳回指定的值；否則，傳回計算結果。 | `=IFERROR(value, value_if_error)` | `=IFERROR(VLOOKUP(A2, B:C, 2, FALSE), "查無資料")`：如果 VLOOKUP 找不到資料 (產生錯誤)，則顯示「查無資料」，否則顯示查找結果。 |

建議在面試前，針對這些函式（特別是 **VLOOKUP**、**SUMIFS**、**COUNTIFS**、**資料剖析**）多多複習！